# Балансировщик нагрузки с ограничением запросов

Это реализация балансировщика нагрузки на Go с проверкой здоровья серверов и ограничением запросов.

## Основные возможности

- Алгоритм балансировки Round Robin
- Проверка здоровья backend-серверов
- Ограничение запросов на основе Redis
- Динамическое изменение ограничений через API
- Плавное завершение работы (graceful shutdown)
- Настройка через YAML-конфиг

## Конфигурация

Приложение настраивается через файл `config.yaml`:

```yaml
host: "0.0.0.0"         # Хост для запуска сервера
port: "8080"            # Порт для запуска сервера
backends:               # Список backend-серверов
  - "http://backend1:8080"
  - "http://backend2:8080"
health_checker:         # Настройки проверки здоровья
  interval: "10s"       # Интервал проверки
  timeout: "5s"         # Таймаут проверки
rate_limiting:          # Настройки ограничения запросов
  rate_per_second: 10   # Лимит запросов в секунду
  capacity: 20          # Максимальное количество запросов
storage:
  redis:                # Настройки Redis
    host: "redis"       # Хост Redis
    port: 6379          # Порт Redis
    password: ""        # Пароль Redis
```
Управление ограничениями
POST /edit - Изменяет ограничения для конкретного IP

Пример запроса:

```json
{
  "userIP": "1.2.3.4",
  "newRate": 20,
  "newBurst": 30
}
```
## Запуск с Docker
```bash
docker-compose up --build
```
## Сборка
```bash
go build -o balancer cmd/main.go
```

## Переменные окружения

- `CONFIG_PATH` - Путь к конфигурационному файлу (по умолчанию: "./config.yaml")

## Архитектура

1. **Балансировщик нагрузки**:
    
    - Round Robin алгоритм
     
    - Учет состояния серверов (живой/неживой)
     
2. **Проверка здоровья**:
    
    - Регулярные проверки backend-серверов
    
    - Автоматическое исключение неработающих серверов
     
3. **Ограничение запросов**:
    
    - Реализация на основе Redis
    
    - Поддержка динамического изменения лимитов
    
4. **Проксирование**:
    
    - Передача запросов на backend-серверы
        
    - Обработка ошибок соединения
        

## Разработка

### Зависимости

- Go 1.21+
    
- Redis
    
- Docker (для запуска через docker-compose)
